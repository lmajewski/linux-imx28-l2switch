/dts-v1/;
#include "imx28.dtsi"

/ {
	model = "XEA";
	compatible = "fsl,imx28";

	aliases {
		spi2 = &ssp3;
	};

	chosen {
		bootargs = "root=/dev/mmcblk0p2 rootfstype=ext4 ro rootwait console=ttyAMA0,115200 panic=1";
	};

	memory {
		reg = <0x40000000 0x10000000>;
	};

	regulators {
		compatible = "simple-bus";
		#address-cells = <1>;
		#size-cells = <0>;

		reg_3v3: regulator@0 {
			compatible = "regulator-fixed";
			reg = <0>;
			regulator-name = "3V3";
			regulator-min-microvolt = <3300000>;
			regulator-max-microvolt = <3300000>;
			regulator-always-on;
		};

		reg_usb_5v: regulator@1 {
			compatible = "regulator-fixed";
			reg = <1>;
			regulator-name = "usb_vbus";
			regulator-min-microvolt = <5000000>;
			regulator-max-microvolt = <5000000>;
			gpio = <&gpio0 2 0>;
			enable-active-high;
		};

                reg_fec_3v3: regulator@2 {
                        compatible = "regulator-fixed";
                        reg = <2>;
                        regulator-name = "fec-phy";
                        regulator-min-microvolt = <3300000>;
                        regulator-max-microvolt = <3300000>;
                        gpio = <&gpio0 0 0>;
                        enable-active-high;
                };
	};
};

&pinctrl {
	pinctrl-names = "default";
	pinctrl-0 = <&hog_pins_a &hog_pins_tiva>;

	hog_pins_a: hog@0 {
		reg = <0>;
		fsl,pinmux-ids = <
			MX28_PAD_GPMI_D05__GPIO_0_5
			MX28_PAD_GPMI_CE1N__GPIO_0_17
			MX28_PAD_GPMI_RDY1__GPIO_0_21
			MX28_PAD_GPMI_RDY2__GPIO_0_22
			MX28_PAD_GPMI_RDN__GPIO_0_24
			MX28_PAD_GPMI_CLE__GPIO_0_27
			MX28_PAD_LCD_VSYNC__GPIO_1_28
			MX28_PAD_SSP1_SCK__GPIO_2_12
			MX28_PAD_SSP1_CMD__GPIO_2_13
			MX28_PAD_SSP2_SS1__GPIO_2_20
			MX28_PAD_SSP2_SS2__GPIO_2_21
			MX28_PAD_LCD_D00__GPIO_1_0
			MX28_PAD_LCD_D01__GPIO_1_1
			MX28_PAD_LCD_D02__GPIO_1_2
			MX28_PAD_LCD_D03__GPIO_1_3
			MX28_PAD_LCD_D04__GPIO_1_4
			MX28_PAD_LCD_D05__GPIO_1_5
			MX28_PAD_LCD_D06__GPIO_1_6
		>;
		fsl,drive-strength = <MXS_DRIVE_4mA>;
		fsl,voltage = <MXS_VOLTAGE_HIGH>;
		fsl,pull-up = <MXS_PULL_DISABLE>;
	};

	hog_pins_tiva: hog@1 {
		reg = <1>;
		fsl,pinmux-ids = <
			MX28_PAD_GPMI_RDY3__GPIO_0_23
			MX28_PAD_GPMI_WRN__GPIO_0_25
		>;
		fsl,drive-strength = <MXS_DRIVE_4mA>;
		fsl,voltage = <MXS_VOLTAGE_HIGH>;
		fsl,pull-up = <MXS_PULL_ENABLE>;
	};
};

&duart {
	pinctrl-names = "default";
	pinctrl-0 = <&duart_pins_a>;
	status = "okay";
};

&i2c0 {
	pinctrl-names = "default";
	pinctrl-0 = <&i2c0_pins_a>;
	status = "okay";
};

&i2c1 {
	pinctrl-names = "default";
	pinctrl-0 = <&i2c1_pins_b>;
	status = "okay";
};

&can0 {
	pinctrl-names = "default";
        pinctrl-0 = <&can1_pins_a>;
        status = "okay";
};

&mac0 {
	phy-mode = "rmii";
        pinctrl-names = "default";
        pinctrl-0 = <&mac0_pins_a>;
        phy-supply = <&reg_fec_3v3>;
        phy-reset-gpios = <&gpio2 13 0>;
        phy-reset-duration = <100>;
        local-mac-address = [ 00 11 B8 00 BF 8A ];
        status = "okay";
};

&mac1 {
        phy-mode = "rmii";
        pinctrl-names = "default";
        pinctrl-0 = <&mac1_pins_a>;
        status = "okay";
};

&eth_switch {
	compatible = "fsl,mxs-l2switch";
	pinctrl-names = "default";
	pinctrl-0 = <&mac0_pins_a>, <&mac1_pins_a>;
	phy-mode = "rmii";
	phy-supply = <&reg_fec_3v3>;
	phy-reset-gpios = <&gpio2 13 0>;
	phy-reset-duration = <100>;
	interrupts = <100>, <101>, <102>;
	clocks = <&clks 57>, <&clks 57>, <&clks 64>;
	clock-names = "ipg", "ahb", "enet_out";
	local-mac-address = [ 00 11 22 AA BB CC ];
	status = "okay";

	mdio@0 {
		reg = <0x0>;
		#address-cells = <1>;
		#size-cells = <0>;

		ethernet-phy@0 {
			reg = <0>;
		};

		ethernet-phy@1 {
			reg = <1>;
		};
	};
};

&saif0 {
	pinctrl-names = "default";
	pinctrl-0 = <&saif0_pins_a>;
	#sound-dai-cells = <0>;
	assigned-clocks = <&clks 53>;
	assigned-clock-rates = <12000000>;
	status = "okay";
};

&saif1 {
	pinctrl-names = "default";
	pinctrl-0 = <&saif1_pins_a>;
	fsl,saif-master = <&saif0>;
	#sound-dai-cells = <0>;
	status = "okay";
};

&ssp3 {
	compatible = "fsl,imx28-spi";
	pinctrl-names = "default";
	pinctrl-0 = <&spi3_pins_a>;
	status = "okay";
	
	flash0: s25fl256s0@0 {
		compatible = "s25fl256s1", "jedec,spi-nor";
		spi-max-frequency = <40000000>;
		reg = <0>;

		partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;

			partition@0 {
				label = "u-boot";
				reg = <0 0x80000>;
				read-only;
			};

			partition@80000 {
				label = "env0";
				reg = <0x80000 0x10000>;
			};

			partition@90000 {
				label = "env1";
				reg = <0x90000 0x10000>;
			};

			partition@100000 {
				label = "kernel";
				reg = <0x100000 0x400000>;
			};

			partition@500000 {
				label = "swupdate";
				reg = <0x500000 0x800000>;
			};
		};
	};
	
};

&ssp2 {
	compatible = "fsl,imx28-spi";
	pinctrl-names = "default";
	pinctrl-0 = <&spi2_pins_a>;
	status = "okay";
};

&ssp0 {
        compatible = "fsl,imx28-mmc";
        pinctrl-names = "default";
        pinctrl-0 = <&mmc0_8bit_pins_a>;
        bus-width = <8>;
        vmmc-supply = <&reg_3v3>;
        non-removable;
        status = "okay";
};

&usb0 {
	vbus-supply = <&reg_usb_5v>;
	pinctrl-names = "default";
	pinctrl-0 = <&usb0_pins_b>, <&usb0_id_pins_a>;
	dr_mode = "host";
	status = "okay";
};

&usbphy0 {
	status = "okay";
};

&usb1 {
	vbus-supply = <&reg_usb_5v>;
	pinctrl-names = "default";
	pinctrl-0 = <&usb1_pins_b>;
	dr_mode = "host";
	status = "okay";
};

&usbphy1 {
	status = "okay";
};
